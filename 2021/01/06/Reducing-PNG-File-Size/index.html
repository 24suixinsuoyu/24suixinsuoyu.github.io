<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="manifest" href="/images/manifest.json">
  <meta name="msapplication-config" content="/images/browserconfig.xml">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"24suixinsuoyu.com","root":"/","scheme":"Mist","version":"7.7.2","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Colt McAnlis · Apr 14, 2016 · 9 min read">
<meta property="og:type" content="article">
<meta property="og:title" content="Reducing PNG File Size">
<meta property="og:url" content="http://24suixinsuoyu.com/2021/01/06/Reducing-PNG-File-Size/index.html">
<meta property="og:site_name" content="隋钟元’s Blog">
<meta property="og:description" content="Colt McAnlis · Apr 14, 2016 · 9 min read">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://miro.medium.com/max/4320/1*dh_O07HVCbdIWISAd55IBQ.jpeg">
<meta property="og:image" content="https://miro.medium.com/max/1230/1*AaAgW3WKzGcWUD0a8wbmQQ.png">
<meta property="og:image" content="https://miro.medium.com/max/392/1*ifzr3HwaURqE-3okFHRe9g.png">
<meta property="og:image" content="https://miro.medium.com/max/844/1*Yq3LFOb4NmzMHed0AJ-4Aw.png">
<meta property="og:image" content="https://miro.medium.com/max/1246/1*CdJdTqpCKr7gC3zOkuILDA.png">
<meta property="og:image" content="https://miro.medium.com/max/1246/1*ZpTATiM39cPjSgyVEaLTeA.png">
<meta property="og:image" content="https://miro.medium.com/max/800/1*w5GkS92LEORhfT1_t3jygg.gif">
<meta property="og:image" content="https://miro.medium.com/max/1400/1*mZxHiZEee9u99jJZ9CMHHQ.png">
<meta property="article:published_time" content="2021-01-06T15:09:51.000Z">
<meta property="article:modified_time" content="2021-02-09T10:47:07.846Z">
<meta property="article:author" content="隋钟元">
<meta property="article:tag" content="Technology">
<meta property="article:tag" content="PNG">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://miro.medium.com/max/4320/1*dh_O07HVCbdIWISAd55IBQ.jpeg">

<link rel="canonical" href="http://24suixinsuoyu.com/2021/01/06/Reducing-PNG-File-Size/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>Reducing PNG File Size | 隋钟元’s Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">隋钟元’s Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-university"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th-list"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-english">

    <a href="/english/" rel="section"><i class="fa fa-fw fa-graduation-cap"></i>英语</a>

  </li>
        <li class="menu-item menu-item-life">

    <a href="/life/" rel="section"><i class="fa fa-fw fa-balance-scale"></i>生活</a>

  </li>
        <li class="menu-item menu-item-resume">

    <a href="/resume/" rel="section"><i class="fa fa-fw fa-user-circle-o"></i>简历</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/commonweal/" rel="section"><i class="fa fa-fw fa-heartbeat"></i>公益 404</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/24suixinsuoyu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://24suixinsuoyu.com/2021/01/06/Reducing-PNG-File-Size/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="隋钟元">
      <meta itemprop="description" content="技术创造价值">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="隋钟元’s Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Reducing PNG File Size
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-06 23:09:51" itemprop="dateCreated datePublished" datetime="2021-01-06T23:09:51+08:00">2021-01-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-09 18:47:07" itemprop="dateModified" datetime="2021-02-09T18:47:07+08:00">2021-02-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E3%80%8ATechnology-Articles%E3%80%8B/" itemprop="url" rel="index"><span itemprop="name">《Technology Articles》</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>9.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>Colt McAnlis · Apr 14, 2016 · 9 min read</p>
</blockquote>
<a id="more"></a>

<p><img src="https://miro.medium.com/max/4320/1*dh_O07HVCbdIWISAd55IBQ.jpeg" alt="PNG"></p>
<p>One of the benefits of my <a href="https://www.youtube.com/playlist?list=PLWz5rJ2EKKc9CBxr3BVjPTPoDPLdPIFCE" target="_blank" rel="noopener">role here at Google</a> is that I get to troll through a lot of Android applications, and look for common places where people might be able to improve their performance.</p>
<p>Lately, I’ve been noticing the growth of a frightening trend: <strong>Bloated PNG files</strong>.</p>
<p>As I talked about last time, <a href="https://medium.com/@duhroach/how-png-works-f1174e3cc7b7" target="_blank" rel="noopener">PNG is a pretty awesome, flexible image file format</a>. It’s got great quality control, and supports transparency. As such, it’s become the go-to for transparency-seeking developers for a few decades now.</p>
<p>The problem is that it’s pretty easy to make bloated PNG files; heck, <a href="http://encode.ru/threads/1725-pngthermal-pseudo-thermal-view-of-PNG-compression-efficiency" target="_blank" rel="noopener">just adding two pixels to the width of your image could double</a> its size. So, it’s easy to assume that most of the PNGs out there just haven’t been given the love &amp; care they deserve.</p>
<p>So, now that I’ve trolled through about 100 APKs, I’ve decided to pass along my top suggestions on reducing PNG file size. These suggestions are based on things I’ve seen in real apps that real humans are using. YMMV if your app is only used by robots, or small squirrels.</p>
<h3 id="You-should-be-using-an-optimizer-tool"><a href="#You-should-be-using-an-optimizer-tool" class="headerlink" title="You should be using an optimizer tool"></a>You should be using an optimizer tool</h3><p>Once you understand the <a href="https://medium.com/@duhroach/how-png-works-f1174e3cc7b7" target="_blank" rel="noopener">PNG file</a> format, it becomes clear that there’s some obvious areas of improvement that could result in smaller file sizes:</p>
<ul>
<li>Removing unneeded chunks</li>
<li>Reducing unique colors</li>
<li>Optimizing line-by-line filter choice</li>
<li>Optimizing DEFLATE compression</li>
</ul>
<p>And this isn’t new information. PNG optimazation has been a common problem for a long time; 20 years ago, <a href="https://en.wikipedia.org/wiki/Ken_Silverman" target="_blank" rel="noopener">Ken Silverman</a> wrote one of the first popular PNG optimizers, <a href="http://advsys.net/ken/utils.htm" target="_blank" rel="noopener">PNGOUT</a>.(Which became the backbone of the famous <a href="https://en.wikipedia.org/wiki/Duke_Nukem_3D" target="_blank" rel="noopener">Duke Nukem 3D</a> engine.) Since then, there’s been a lot of new PNG optimizers that have hit the scene; A quick google search will bring up a plethora of options for you to choose from:</p>
<p><a href="https://pngquant.org/" target="_blank" rel="noopener">PNGQuant</a>, <a href="http://www.imagemagick.org/script/index.php" target="_blank" rel="noopener">ImageMagick</a>, <a href="http://pnggauntlet.com/" target="_blank" rel="noopener">PNGGauntlet</a>, <a href="http://advsys.net/ken/utils.htm" target="_blank" rel="noopener">PNGOut</a>, <a href="http://pmt.sourceforge.net/pngcrush/" target="_blank" rel="noopener">PNGCrush</a>, <a href="http://optipng.sourceforge.net/" target="_blank" rel="noopener">OptiPNG</a>, <a href="http://encode.ru/threads/1260-CryoPNG-short-introduction" target="_blank" rel="noopener">CryoPNG</a>, <a href="http://www.shpakovski.com/png-compressor/" target="_blank" rel="noopener">PNG Compressor</a>, <a href="http://www.imgopt.com/" target="_blank" rel="noopener">Yahoo Smush.it</a>, <a href="http://psydk.org/pngoptimizer" target="_blank" rel="noopener">PNGOptimizer</a>, <a href="http://www.punypng.com/" target="_blank" rel="noopener">PunyPNG</a>, <a href="https://tinypng.com/" target="_blank" rel="noopener">TinyPNG</a>, <a href="https://github.com/hoehrmann/pngwolf" target="_blank" rel="noopener">PNGWolf</a>, <a href="http://www.advancemame.it/doc-advpng.html" target="_blank" rel="noopener">Advpng</a>, <a href="http://encode.ru/threads/455-Ben-Jos-Walbeehm-s-DeflOpt-what-does-it-actually-do" target="_blank" rel="noopener">DeflOpt</a>, <a href="http://encode.ru/threads/1214-defluff-a-deflate-huffman-optimizer" target="_blank" rel="noopener">Defluff</a>, <a href="http://encode.ru/threads/1313-Huffmix-a-PNGOUT-r-catalyst" target="_blank" rel="noopener">Huffmix</a>, <a href="http://en.css-ig.net/" target="_blank" rel="noopener">TruePNG</a>, <a href="https://sourceforge.net/projects/pngnqs9/" target="_blank" rel="noopener">PNGngs9</a>, <a href="https://github.com/pornel/mediancut-posterizer" target="_blank" rel="noopener">Median Cut Posterizer</a>, <a href="http://css-ig.net/scriptpng" target="_blank" rel="noopener">scriptpng</a>, <a href="http://css-ig.net/pngslim" target="_blank" rel="noopener">pngslim</a>, <a href="https://github.com/google/zopfli" target="_blank" rel="noopener">zopfliPNG</a></p>
<p>The trick here, is that in the full spectrum of things a tool could do, each one of these tools does a subset of it; So there’s no “best tool” for the job, so make sure you’re spending the time to evaluate which one works best for you, and then adopt the hell out of it.</p>
<p>FWIW, A personal favorite of mine on that list has to be <a href="https://github.com/google/zopfli" target="_blank" rel="noopener">zopfliPNG</a>. It reduces PNG file size by providing a more efficient, and powerful deflate stage in the compressor, allowing it to find better matches in your data. It can decreate the PNG file-size by 5%, without impacting image quality in any form… sure it’s significantly slower, but it’s impressive that improvements can still be made to the old-school DEFLATE codec.</p>
<p>The gist here, is that if you’ve got a lot of data coming through your application, you should have a PNG optimization tool in your upload/distribute pipeline, if only to keep the crazy at bay.</p>
<h3 id="Reducing-Colors"><a href="#Reducing-Colors" class="headerlink" title="Reducing Colors"></a>Reducing Colors</h3><p>Now, if the above tools just aren’t working for you, or you’d like to adopt a more manual approach to improving some of your assets before it gets tossed to one of the above tools, then it’s worth taking matters into your own hands.</p>
<p>Even though there’s a lot of things you could manually do, I suggest that you should only focus on <strong>reduing the number of unique colors in your image</strong> and then let a tool take it the rest of the way.</p>
<p>The reason for your focus here, is that reducing unique colors directly influences the compression potential at every other stage of the pipeline; and tools can do the rest.</p>
<p>See, the <strong>filtering</strong> stage of the PNG compression step is powered by how variant adjacent pixel colors are to each other. As such reducing the number of unique colors in the will reduce variation in adjacent pixels, decreasing the dynamic range of values that are spit out from filtering.</p>
<p>As a result, the <strong>DEFLATE</strong> stage will find more duplicate values, and be able to compress better.</p>
<p>It’s worth nothing though, that reducing the number of unique colors, we’re effectively applying a lossy encoding stage to our images. THIS is why you should handle this process manually. Tools have a difficult time understanding human perceptual quality, and in some cases, small errors to a tool can look like huge errors to a human eye. But, if done the right way, it shouldn’t be noticeable to the user, and can save a huge amount of space.</p>
<h3 id="PSA-Choose-the-right-pixel-format"><a href="#PSA-Choose-the-right-pixel-format" class="headerlink" title="PSA: Choose the right pixel format"></a>PSA: Choose the right pixel format</h3><p>This shold go without saying.. But I’ve seen example in a few APKs that prove otherwise:</p>
<p><strong>You should make sure to use the right pixel format for your PNG file.</strong></p>
<p>For example, if you <strong>don’t</strong> have alpha in the image, then using the RGBA 32bpp option is a waste of an entire 1/4 of your image; instead, use the 24bpp true color format(or jsut use JPG). Likewise, if your image just contains grayscale data, you should only be storing it as 8bpp.</p>
<p>Basically, make sure you’re not unintentionally bloating your PNG file by using the wrong type of pixel format.</p>
<h3 id="Indexed-images-FTW"><a href="#Indexed-images-FTW" class="headerlink" title="Indexed images, FTW!"></a>Indexed images, FTW!</h3><p>Moving on, color reduction should always start with taking a stab at trying to optimize your colors so that it could be defined using the INDEXED format. INDEXED color mode, basically choose the best 256 colors to use, and replaces all your pixels with an index into that color palette. The result, is a reduction from 16 million colors(24bpp) to 256, which is a significant saving.</p>
<p>Here’s an example image, and it’s indexed variant:</p>
<p><img src="https://miro.medium.com/max/1230/1*AaAgW3WKzGcWUD0a8wbmQQ.png" alt="Indexed"> </p>
<p>The example Google Doodle above was exported in Photoshop’s “save for web” feature, and the image format was set to PNG8, which created this color palette for the image:</p>
<p><img src="https://miro.medium.com/max/392/1*ifzr3HwaURqE-3okFHRe9g.png" alt="Indexed"></p>
<p>Basically, by moving to indexed images, you’ve replaced the unique color at each pixel, with a pointer into the palette instead. The result is moving from a 32bit per pixel to 8 bits per pixel, which is a nice first-step file size reduction.</p>
<p>This mode creates further savings when you consider how the filtering and deflate stages are applied:</p>
<ol>
<li>The number of unique pixels has been reduced, meaning that there’s a higher probability adjacent colors will point to the same color.</li>
<li>Since the number of similar adjacent colors increases, the filtering stage will produce more duplicate values, such that the LZ77 phase of DEFLATE can compress it better.</li>
</ol>
<p>If you can represent your image as a paletted images, then you’ve gone a great way to significantly improving the file size, so it’s worth investigating if the majority of your images can be converted over.</p>
<h3 id="Optimizing-fully-transparent-pixels"><a href="#Optimizing-fully-transparent-pixels" class="headerlink" title="Optimizing fully transparent pixels"></a>Optimizing fully transparent pixels</h3><p>One of the nice features of INDEXED mode, is that you can denote specific colors in your palette to act as “transparent”. When the PNG file is decoded into RGBA in main memory, transparent pixels will be set accordingly. What’s interesting here is that this transparency mode is entirely binary; a given pixel is either visible, or not.</p>
<p><img src="https://miro.medium.com/max/844/1*Yq3LFOb4NmzMHed0AJ-4Aw.png" alt="Optimizer"></p>
<p>This type of “punch through” transparency is pretty dfficient in terms of compression; Normally, it’s used for large areas of the background that are transparent, and as such, there’s lots of self-similar pixels that the PNG Compressor can take advantage of.</p>
<p>But it’s only available in indexed mode. There are situations where you want to use the same “punch through” transparency, but need to use full RGB mode as well.</p>
<p>In these cases, it’s easy to make the mistake of not properly masking out your invisible pixels. Consider the example below; both images support transparency &amp; Truecolor, but one of them is significantly smaller.</p>
<p><img src="https://miro.medium.com/max/1246/1*CdJdTqpCKr7gC3zOkuILDA.png" alt="pixels"></p>
<p>The reason for this size difference becomes apparent, when you disable the alpha channel:</p>
<p><img src="https://miro.medium.com/max/1246/1*ZpTATiM39cPjSgyVEaLTeA.png" alt="pixels"></p>
<p>Even though the Alpha channel will only allow some portion of the image to be rendered, there’s a FULL SET of pixel data in the RGB layer, meaning that the filtering &amp; DEFLATE stages will still have to go through and compress all that data.</p>
<p>Instead, if you know those pixels won’t be seen, make sure they are homogeneous. When we will the non-visible pixels with a singler value; So we’ve flattened the parts of the image that won’t be seen.</p>
<p>The result is that more of each row is a single color, and thus the interpolation predictor, and Deflate stages will produce better compression. Basically, this is a fun little hack to let you get punch-through transparency, in true-color mode, with a smaller file-size footprint.</p>
<h3 id="Lossy-Pre-process"><a href="#Lossy-Pre-process" class="headerlink" title="Lossy Pre-process"></a>Lossy Pre-process</h3><p>The indexed mode in PNG is fantastic, but sadly, not every image will be able to be accurately represented with only 256 colors. Some might need 257,310,512 colors, or 912 colors to look correct. Sadly, since Indexed mode only supports 256 colors, these images have to default all the way to 24bpp, even though only a subset of colors are actually needed.</p>
<p>Thankfully though, you can get pretty close to index savings by reducing colors manually.</p>
<p>The process of creating an indexed image, may be better descripted as <a href="https://en.wikipedia.org/wiki/Vector_quantization" target="_blank" rel="noopener">vector quantization</a>. It’s sort of a rounding process for multidimensional numbers. More directly, all the colors in your image get grouped based upon their similarity. For a given group, all colors in that group are replaced by a single “center point” value, which minimizes error for colors in that cell.(or, “site” if you’re using the <a href="https://en.wikipedia.org/wiki/Voronoi_diagram" target="_blank" rel="noopener">Voronoi terminology</a>)</p>
<p>The image below shows this process for a 2D set of values.</p>
<p><img src="https://miro.medium.com/max/800/1*w5GkS92LEORhfT1_t3jygg.gif" alt="Lossy"></p>
<center style="font-size:14px;color:#C0C0C0;text-decoration:underline">Green dots represent all input values in this 2D space. Bule lines represent "cells" or "clumps" of similar colors, and the red dots denote the representative color for that cell. The process of VQ for images means for every pixel, replacing it with the representative color for it's VQ cell.</center>

<p>The result of applying VQ to an image has the effect of reducing the number of unique colors, replacing it with a single color thats “pretty colose” in visual quality.</p>
<p>It also has the ability to allow you to define the “maximum” number of unique colors in your image.</p>
<p>For example, the image below shows the 24-bit-per-pixel version of a parrot head, vs a version that only allowed 16 total unique colors to be used.</p>
<p><img src="https://miro.medium.com/max/1400/1*mZxHiZEee9u99jJZ9CMHHQ.png" alt="parrot"></p>
<p>Immediately, you can see that there’s a loss of quality; most of the gradient colors have been replaced, giving the “banding” effect to the visual quality; obviously this image needs more than the 16 unique colors we gave it.</p>
<p>Setting up a VQ step in your pipeline can help you get a better sense of the true number of unique colors that your image uses, and can help you reduce them significantly. Sadly though, I don’t know of any image optimization tool out there that allows you to specify these values manually, other than <a href="https://pngquant.org/" target="_blank" rel="noopener">pngquant</a>. So, unless you’re using that tool, you might have to create your own VQ code to do this.</p>
<h3 id="It’s-all-about-collaboration"><a href="#It’s-all-about-collaboration" class="headerlink" title="It’s all about collaboration"></a>It’s all about collaboration</h3><p>The truth is, you should be using a tool to help you reduce the size of PNGs to as small as possible; The authors of these tools have spent a lot of time working on the issues, and it’s much faster for you to leverage their work. Thar being said, there’s still a lot of work that can be done by your artists(and yourself) to an image before sending it off to the extra programs to do their magic.</p>
<p>So, go out there and make some smaller PNGs!</p>

    </div>

    
    
    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;margin-top:80px">-------------------- 本文结束<i class="fa fa-paw"></i>感谢您的阅读 --------------------</div>
    
</div>
      
    </div>
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>隋钟元
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://24suixinsuoyu.com/2021/01/06/Reducing-PNG-File-Size/" title="Reducing PNG File Size">http://24suixinsuoyu.com/2021/01/06/Reducing-PNG-File-Size/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Technology/" rel="tag"><i class="fa fa-tag"></i> Technology</a>
              <a href="/tags/PNG/" rel="tag"><i class="fa fa-tag"></i> PNG</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/01/06/Reducing-JPG-File-Size/" rel="prev" title="Reducing JPG File Size">
      <i class="fa fa-chevron-left"></i> Reducing JPG File Size
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/01/06/Smaller-PNGs-and-Android-s-AAPT-tool/" rel="next" title="Smaller PNGs, and Android's AAPT tool">
      Smaller PNGs, and Android's AAPT tool <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#You-should-be-using-an-optimizer-tool"><span class="nav-text">You should be using an optimizer tool</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reducing-Colors"><span class="nav-text">Reducing Colors</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PSA-Choose-the-right-pixel-format"><span class="nav-text">PSA: Choose the right pixel format</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Indexed-images-FTW"><span class="nav-text">Indexed images, FTW!</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Optimizing-fully-transparent-pixels"><span class="nav-text">Optimizing fully transparent pixels</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Lossy-Pre-process"><span class="nav-text">Lossy Pre-process</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#It’s-all-about-collaboration"><span class="nav-text">It’s all about collaboration</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="隋钟元"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">隋钟元</p>
  <div class="site-description" itemprop="description">技术创造价值</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">327</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">454</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:24suixinsuoyu@gmail.com" title="E-Mail → mailto:24suixinsuoyu@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/24suixinsuoyu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;24suixinsuoyu" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/24sxsy" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;24sxsy" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/guolin_blog" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;guolin_blog" rel="noopener" target="_blank">郭霖</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/lmj623565791/" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;lmj623565791&#x2F;" rel="noopener" target="_blank">鸿洋</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.520monkey.com/" title="http:&#x2F;&#x2F;www.520monkey.com&#x2F;" rel="noopener" target="_blank">姜维</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://daimajia.com/" title="https:&#x2F;&#x2F;daimajia.com&#x2F;" rel="noopener" target="_blank">代码家</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://kmxz.net/" title="https:&#x2F;&#x2F;kmxz.net&#x2F;" rel="noopener" target="_blank">孔祥舟</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://yangwenbo.com/" title="http:&#x2F;&#x2F;yangwenbo.com&#x2F;" rel="noopener" target="_blank">杨文博</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">隋钟元</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">1.4m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">21:06</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  















  

  

</body>
</html>

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/clicklove.js"></script>

